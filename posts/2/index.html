
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Kevin Coleman</title>
  <meta name="author" content="Kevin Coleman">

  
  <meta name="description" content="When building a rails application, sometimes it is quicker to build one code base that is shared on two completely different frontend applications. &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.kcoleman.me/posts/2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Kevin Coleman" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet" type="text/css">
<!--- MathJax Configuration -->
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-48081941-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Kevin Coleman</a></h1>
  
    <h2>I am a software engineer at Spark Start with interests in start ups, web apps, and wearables.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscribe" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 13.310204,73.332654 C 5.967347,73.332654 0,79.322448 0,86.621428 c 0,7.338776 5.967347,13.262246 13.310204,13.262246 7.370408,0 13.328572,-5.92245 13.328572,-13.262246 0,-7.29898 -5.958164,-13.288774 -13.328572,-13.288774 z M 0.01530612,33.978572 V 53.143878 C 12.493878,53.143878 24.229592,58.02347 33.068368,66.865306 41.894898,75.685714 46.767346,87.47449 46.767346,100 h 19.25 C 66.017346,63.592858 36.4,33.979592 0.01530612,33.978572 l 0,0 z M 0.03877552,0 V 19.17449 C 44.54796,19.17551 80.77551,55.437756 80.77551,100 H 100 C 100,44.87653 55.15102,0 0.03877552,0 z"></path></svg></a></li>
  
</ul>
  
  
  
  
  
<ul class="subscribe">
  <li><a href="https://github.com/KevinColemanInc" rel="subscribe-github" title="@KevinColemanInc on GitHub"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 50,0 C 22.385714,0 0,22.385714 0,50 0,77.614286 22.385714,100 50,100 77.614286,100 100,77.614286 100,50 100,22.385714 77.614286,0 50,0 z m 29.692858,79.692858 c -3.859184,3.859182 -8.351022,6.887754 -13.35,9.00306 -1.27041,0.536736 -2.560204,1.009184 -3.867348,1.415306 v -7.493878 c 0,-3.938774 -1.35102,-6.835714 -4.053062,-8.690816 1.692858,-0.163264 3.24694,-0.390816 4.663266,-0.683672 1.416326,-0.292858 2.913266,-0.716328 4.491838,-1.27041 1.57857,-0.55408 2.994896,-1.213264 4.247958,-1.97755 1.253062,-0.765306 2.458164,-1.758164 3.613266,-2.978572 1.155102,-1.220408 2.12449,-2.604082 2.905102,-4.15 0.780612,-1.545918 1.4,-3.40204 1.855102,-5.566326 0.455102,-2.164286 0.683674,-4.54898 0.683674,-7.153062 0,-5.045918 -1.643878,-9.341836 -4.931634,-12.890816 C 77.44796,33.35 77.285714,29.10204 75.463266,24.512244 l -1.22143,-0.145918 c -0.845918,-0.09796 -2.368366,0.260204 -4.565306,1.07449 -2.196938,0.814286 -4.663264,2.14796 -7.396938,4.004082 -3.87449,-1.07449 -7.893878,-1.611224 -12.061224,-1.611224 -4.19898,0 -8.203062,0.536734 -12.012246,1.611224 -1.72449,-1.17245 -3.361224,-2.139796 -4.907142,-2.905102 C 31.753062,25.77449 30.516326,25.254082 29.587756,24.97653 28.660204,24.7 27.79796,24.528572 27,24.463266 c -0.79796,-0.0653 -1.310204,-0.08062 -1.537756,-0.04898 -0.22755,0.03164 -0.390816,0.0653 -0.487754,0.09796 -1.82347,4.62245 -1.985714,8.87143 -0.487756,12.743878 -3.287754,3.54796 -4.931632,7.844898 -4.931632,12.890816 0,2.604082 0.227552,4.988776 0.683674,7.153062 0.456122,2.164286 1.07449,4.020408 1.855102,5.566326 0.780612,1.545918 1.75,2.929592 2.905102,4.15 1.155102,1.220408 2.360204,2.213266 3.613264,2.978572 1.253062,0.766326 2.669388,1.42449 4.24796,1.97755 1.578572,0.554082 3.07551,0.976532 4.491836,1.27041 1.416328,0.292856 2.970408,0.521428 4.663266,0.683672 -2.669388,1.82347 -4.004082,4.720408 -4.004082,8.690816 v 7.639796 C 36.536734,89.818368 35.083674,89.3 33.656122,88.695918 c -4.99898,-2.115306 -9.490816,-5.143878 -13.35,-9.00306 -3.859184,-3.859184 -6.887754,-8.351022 -9.00306,-13.35 C 9.1163263,61.171428 8.0071428,55.67347 8.0071428,50 c 0,-5.67347 1.1091835,-11.171428 3.2969392,-16.342858 2.115306,-4.998978 5.143878,-9.490816 9.00306,-13.35 3.859184,-3.859182 8.351022,-6.887754 13.35,-9.00306 C 38.828572,9.1163266 44.32653,8.0071428 50,8.0071428 c 5.67347,0 11.171428,1.1091838 16.342858,3.2969392 5,2.115306 9.490816,5.143878 13.35,9.00306 3.859182,3.859184 6.887754,8.351022 9.00306,13.35 2.186736,5.17245 3.295918,10.67041 3.295918,16.342858 0,5.672448 -1.109182,11.171428 -3.296938,16.342858 -2.115306,4.998978 -5.143878,9.490816 -9.00204,13.35 l 0,0 z"></path></svg></a></li>
</ul>
  
  
  
  
  
<ul class="subscribe">
  <li><a href="https://plus.google.com/+KevinColemanInc" rel="publisher" title="Google+ Profile"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 23.03264,55.19021 C 32.01805,55.457578 38.046082,46.137447 36.495958,34.370183 34.943794,22.603939 26.398215,13.161349 17.411784,12.89296 8.4253533,12.625592 2.3973217,21.630392 3.9494863,33.400718 5.5006303,45.164921 14.043148,54.921821 23.03264,55.19021 z M 99.99898,24.999027 100,0 -0.00797206,0 0.0052943,16.202408 C 5.7047282,11.184661 13.611481,6.9914696 21.771315,6.9914696 c 8.721103,0 34.888495,0 34.888495,0 l -7.807765,6.6035874 -11.062106,0 c 7.33732,2.81349 11.246815,11.3407 11.246815,20.090377 0,7.348545 -4.082979,13.667416 -9.852826,18.161652 -5.629021,4.385043 -6.696453,6.220904 -6.696453,9.948752 0,3.180866 6.030073,8.594563 9.183386,10.81923 9.217061,6.498477 12.199952,12.530591 12.199952,22.603843 0,1.604209 -0.198996,3.206378 -0.591884,4.780993 L 100,100 c 0,0 0,-46.594917 0,-68.751495 l -18.750474,0 0,18.750475 -6.250499,0 0,-18.750475 -18.750474,0 0,-6.250498 18.750474,0 0,-18.7494538 6.250499,0 0,18.7494538 18.750474,0 z M 18.147557,74.798916 c 2.111393,0 4.04522,-0.05817 6.048441,-0.05817 -2.651232,-2.571634 -4.749358,-5.722905 -4.749358,-9.606889 0,-2.305285 0.738834,-4.52485 1.77157,-6.496436 -1.053145,0.0745 -2.127721,0.09695 -3.234952,0.09695 -7.261803,0 -13.4286215,-2.351208 -17.99020957,-6.236212 l 0,6.56685 0.00102048,19.70055 C 5.2128523,76.28781 11.409265,74.798916 18.147557,74.798916 z M 44.474145,93.051391 C 43.002599,87.308076 37.788918,84.46091 30.518951,79.420713 c -2.644088,-0.85313 -5.556565,-1.35521 -8.681304,-1.387866 -8.752739,-0.09389 -17.2452523,3.525266 -21.84561906,8.743028 l 0,13.224125 44.64641606,-0.0011 c 0,0 0.263286,-2.21038 0.263286,-3.362512 -10e-4,-1.222547 -0.151032,-2.419581 -0.427585,-3.58498 z"></path></svg></a></li>
</ul>
  
  
  
    
      <form action="https://google.com/search" method="get">
        <fieldset role="search">
          <input type="hidden" name="q" value="site:www.kcoleman.me" />
    
          <input class="search" type="text" name="q" results="0" placeholder="Search"/>
        </fieldset>
      </form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/projects">Projects</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/coleman-laws">Coleman Laws</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/09/one-rails-app-two-web-applications/">One Rails App Two Web Applications</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-09T17:11:45-07:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>5:11 pm</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/mountains.jpeg" title="One Rails App Two Web Applications" class="banner-img"  /></p>

<p>When building a rails application, sometimes it is quicker to build one code base that is shared on two completely different frontend applications.  I am going to discuss the design approaches I used to segregate the two rails websites within a single rails application base.</p>

<h2>Configuring the Front End</h2>

<p>My first &lsquo;trick&rsquo; is to build the system such that all interactions are run through an RESTful API.  This gives one surface area for applications (front end apps or mobile or whatever) and it reduces the amount of duplication that maybe experienced across the two different websites.</p>

<p>For my projects, I lean towards AngularJS, mainly because there is a strong community backing the technology, not to mention this is one of Google&rsquo;s babies.</p>

<p>Both of these websites will have a unique look and feel as well as style sheets and html designs.</p>

<h3>Break apart the CSS files</h3>

<p>I divided my assets/stylesheets folder to look like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  assets/stylesheets/application.css
</span><span class='line'>  assets/stylesheets/app1/app1.css
</span><span class='line'>  assets/stylesheets/app2/app2.css</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>application.css</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="c">/*</span>
</span><span class='line'><span class="c"> *= require_self</span>
</span><span class='line'><span class="c"> */</span>
</span></code></pre></td></tr></table></div></figure>


<p>Note how I removed the standard <code>require_tree .</code> line to prevent it from auto loading the entire project.  I just want it to load global attributes for the two applications.</p>

<figure class='code'><figcaption><span>app1.css.scss</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="k">@import</span> <span class="s2">&quot;compass/reset&quot;</span>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;compass&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;app1/partials/variables&quot;</span>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;app1/partials/typography&quot;</span>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;app1/partials/footer&quot;</span>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;app1/partials/alerts&quot;</span>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;app1/partials/buttons&quot;</span>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;app1/partials/sprites&quot;</span>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;app1/partials/navigation&quot;</span>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;app1/partials/modals&quot;</span>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;app1/partials/framework_and_overrides&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;app1/pages/bootstrap_override&quot;</span>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;app1/pages/questions&quot;</span>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;app1/pages/content&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here I am explicitly including the app1.css resources in app1.</p>

<p>application.css will include styling that is shared between the two applications.  An example, might be your frameworks like bootstrap.</p>

<p>appN.css will include the styles that are unique to your web application.  You should create an /assets/stylesheets/app1/ folder to house all of your style sheets for that specific app.</p>

<p>In my layouts view, you will only want to be loading app1 and application when a user requests an app1 website and app2 and application when the user requests an app2 website.</p>

<p>By checking the request host, you can determine the domain the user is on you can decide which css files need to be delivered to the client.  The host check should be offloaded to a helper method that would like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">app1?</span>
</span><span class='line'>    <span class="s1">&#39;app1.com&#39;</span> <span class="o">==</span> <span class="n">request</span><span class="o">.</span><span class="n">host</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the rails views layout folder, you only include the style sheets that are used</p>

<figure class='code'><figcaption><span>layout.html.slim</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">==</span> <span class="n">stylesheet_link_tag</span> <span class="s2">&quot;application&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&gt;</span> <span class="s1">&#39;all&#39;</span>
</span><span class='line'><span class="o">-</span> <span class="k">if</span> <span class="n">app1?</span>
</span><span class='line'>  <span class="o">==</span> <span class="n">stylesheet_link_tag</span> <span class="s2">&quot;app1&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&gt;</span> <span class="s1">&#39;all&#39;</span>
</span><span class='line'><span class="o">-</span> <span class="k">elsif</span> <span class="n">app2?</span>
</span><span class='line'>  <span class="o">==</span> <span class="n">stylesheet_link_tag</span> <span class="s2">&quot;app2&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&gt;</span> <span class="s1">&#39;all&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>You need to tell rails to precompile these new css files</p>

<figure class='code'><figcaption><span>config/initializers/assets.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">precompile</span> <span class="o">+=</span> <span class="sx">%w( app1.css app2.css )</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Javascript Divorce</h3>

<p>You can use a similar technique to break up your javascript files into two projects</p>

<figure class='code'><figcaption><span>layout.html.slim</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="o">==</span> <span class="n">javascript_include_tag</span> <span class="s1">&#39;application&#39;</span>
</span><span class='line'>  <span class="o">-</span> <span class="k">if</span> <span class="n">app1?</span>
</span><span class='line'>    <span class="o">==</span> <span class="n">javascript_include_tag</span> <span class="s1">&#39;app1&#39;</span>
</span><span class='line'>  <span class="o">-</span> <span class="k">elsif</span> <span class="n">app2?</span>
</span><span class='line'>    <span class="o">==</span> <span class="n">javascript_include_tag</span> <span class="s1">&#39;app2&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Don&rsquo;t forget to tell rails to precompile these new assets.</p>

<figure class='code'><figcaption><span>config/initializers/assets.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">precompile</span> <span class="o">+=</span> <span class="sx">%w( app1.js app2.js )</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Backend</h2>

<p>If you want to turn certain features on and off for certain applications, you should use the <a href="https://github.com/FetLife/rollout">rollout gem</a>.  It is a great tool for enabling and disabling features on the fly, or just completely locking up certain parts of the application.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/07/angularjs-rails-and-seo-part-2/">Angularjs Rails and SEO Part 2</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-07T17:26:43-07:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>5:26 pm</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/beach.jpeg" title="Angularjs Rails and SEO Part 2" class="banner-img"  /></p>

<p>This is a continuation post from <a href="/blog/2014/10/03/angularjs-rails-seo/">Angularjs Rails and SEO Part 1</a>.</p>

<p>Now we need to configure Ruby on Rails to redirect Google&rsquo;s requests to get the non-ajax version of the page.  Google flags requests by replacing the &lsquo;#!&rsquo; in the url with <code>?_escaped_fragment_=</code> so you can know the route it is trying to fetch.</p>

<p>To catch this, we will add a <code>before_filter</code> to the application controller to watch for the <code>_escaped_fragment_</code> parameter.  This could will look like:</p>

<figure class='code'><figcaption><span>application_controller.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="n">protect_from_forgery</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">before_filter</span> <span class="ss">:catch_escaped_fragment</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">protected</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">catch_escaped_fragment</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">fragment</span> <span class="o">=</span> <span class="n">params</span><span class="o">[</span><span class="ss">:_escaped_fragment_</span><span class="o">]</span>
</span><span class='line'>      <span class="c1"># Build the original url</span>
</span><span class='line'>      <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">request</span><span class="o">.</span><span class="n">protocol</span><span class="si">}#{</span><span class="n">request</span><span class="o">.</span><span class="n">host_with_port</span><span class="si">}#{</span><span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>      <span class="n">url_with_hash</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">#!</span><span class="si">#{</span><span class="n">params</span><span class="o">[</span><span class="ss">:_escaped_fragment_</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1"># Render it with the PhantomJS script and return the result</span>
</span><span class='line'>      <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;phantomjs &#39;</span><span class="si">#{</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="s2">/lib/phantomjs/ember_to_static.js&#39; &#39;</span><span class="si">#{</span><span class="n">url_with_hash</span><span class="si">}</span><span class="s2">&#39; silence&quot;</span>
</span><span class='line'>      <span class="n">result</span> <span class="o">=</span> <span class="sb">`</span><span class="si">#{</span><span class="n">command</span><span class="si">}</span><span class="sb">`</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">render</span> <span class="ss">text</span><span class="p">:</span> <span class="n">result</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This rails application controller code will trigger the phantomjs script we wrote in the previous blog post.  Since it asks to run it in silent mode, we can take the entire log output of the script (which should be the completed AngularJS application) and return that to google.</p>

<h2>Rails concurrency</h2>

<p>Because this methodology is blocking the thread request, when phantomjs tries to fetch the angularjs page, the website hangs. Because rails only executes one request at a time, phantomJS&rsquo;s request will sit and wait forever, since the request it is currently in will never finish.   To fix this, you will need to run your server with passenger.  Passenger can handle multiple requests in Ruby.</p>

<p>Add <code>gem 'passenger'</code> to your Gemfile. Then you can run it like this</p>

<p>and to run the application you can run <code>passenger -p 3000 -a 127.0.0.1</code>  if this is your first time running passenger with rails, you will have to follow an installation script.</p>

<p>Awesome! You are finished.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/03/angularjs-rails-seo/">Angularjs Rails and SEO Part 1</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-03T09:05:45-07:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2014</span></span> <span class='time'>9:05 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/mountain.jpeg" title="Angularjs Rails and SEO Part 1" class="banner-img"  /></p>

<h2>Intro</h2>

<p>Today I was handed an interesting project around improve the SEO surface area of an <a href="https://angularjs.org/">AngularJS</a> SPA for a client.  After a bit of research on how to handle this, I decided that I should roll my own tool to solve this problem as it will give me greater flexibility later as opposed to going with a SaaS app like <a href="http://Prerender.io">Prerender.io</a>.</p>

<h2>Basic Concept</h2>

<p>Google says they are doing a much better job <a href="http://googlewebmastercentral.blogspot.com.es/2014/05/understanding-web-pages-better.html">rendering Javascript</a> on websites.  Awesome! But what about the <a href="http://bing.com">other</a> <a href="http://duckduckgo.com">guys</a>?</p>

<p>What we are going to do is leverage <a href="http://phantomjs.org/">PhantomJS</a> to render the angularjs code on the fly as the server requests the dynamic pages.  This way we don&rsquo;t have to deal with maintain a bunch of ERB files or pre-rendering static pages on our server.</p>

<p>The cost will be that the page load time will be a bit slower unfortunately and these requests will be expensive on memory, but we just want the fast (dev time-wise) solution to hit the ground.</p>

<h2>PhantomJS client</h2>

<p>First you need to <a href="http://phantomjs.org/download.html">install PhantomJS</a>.  If you are using Heroku to host your application, you will need to configure Heroku to run phantomjs with <a href="https://github.com/stomita/heroku-buildpack-phantomjs">this build back</a>.</p>

<p>Unfortunately there isn&rsquo;t a great way to detect when the page is finished loading.  My trick to solve this problem is for all of the controllers to set a status flag on the <code>body</code> tag noting they are finished running.  Now all of my controllers look like this:</p>

<figure class='code'><figcaption><span>app/assets/javascripts/app/controllers/index.js.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">controller</span> <span class="s">&#39;IndexCtrl&#39;</span><span class="p">,</span> <span class="nf">($scope, $rootScope) -&gt;</span>
</span><span class='line'>  <span class="p">...</span>
</span><span class='line'>  <span class="nv">$rootScope.status = </span><span class="s">&#39;ready&#39;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>and I have this on my <code>body</code> tag</p>

<figure class='code'><figcaption><span>app/views/layouts/application.html.slim</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'>  body data-status=&quot;{ { status } }&quot;
</span></code></pre></td></tr></table></div></figure>


<p>So now I can watch the data-status to see when angular has finished running.</p>

<p>Now lets create a angularjs-to-static.js.coffee file.  This will take in a URL and spit out the html for the page using PhantomJS.</p>

<figure class='code'><figcaption><span>lib/phantomjs/angularjs_to_static.js.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># angularjs_to_static.js.coffee</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># This script takes a URL as argument. (In that order!)</span>
</span><span class='line'><span class="c1"># The script then runs the Javascript on this page and waits until Ember has finished loading.</span>
</span><span class='line'><span class="c1"># It then renders the resulting static HTML page to the console.</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Keep track of whether the page has already been exported. The &#39;setTimeout&#39; mess might cause it to be exported multiple times.</span>
</span><span class='line'><span class="nv">exportPageContents = </span><span class="nf">-&gt;</span>
</span><span class='line'>  <span class="k">unless</span> <span class="nx">pageHasBeenExported</span>
</span><span class='line'>    <span class="nv">pageHasBeenExported = </span><span class="kc">true</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">page</span><span class="p">.</span><span class="nx">content</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;Finished.&quot;</span> <span class="k">unless</span> <span class="nx">silence</span>
</span><span class='line'>    <span class="nx">phantom</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span>
</span><span class='line'>  <span class="k">return</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#wait until angularjs says its ready</span>
</span><span class='line'><span class="nv">waitForStatus = </span><span class="nf">(page, callback) -&gt;</span>
</span><span class='line'>  <span class="nv">expiration = </span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="mi">10000</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># try and fetch the desired element from the page</span>
</span><span class='line'>  <span class="nv">result = </span><span class="nx">page</span><span class="p">.</span><span class="nx">evaluate</span><span class="p">(</span><span class="nf">-&gt;</span>
</span><span class='line'>    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span>
</span><span class='line'>  <span class="p">)</span>
</span><span class='line'>  <span class="nx">system</span><span class="p">.</span><span class="nx">stderr</span><span class="p">.</span><span class="nx">writeLine</span> <span class="nx">result</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># if desired element found then call callback after 50ms</span>
</span><span class='line'>  <span class="k">if</span> <span class="nx">result</span>
</span><span class='line'>    <span class="nx">system</span><span class="p">.</span><span class="nx">stderr</span><span class="p">.</span><span class="nx">writeLine</span> <span class="s">&quot;- trigger found&quot;</span> <span class="k">unless</span> <span class="nx">silence</span>
</span><span class='line'>    <span class="nb">window</span><span class="p">.</span><span class="nx">setTimeout</span> <span class="p">(</span><span class="nf">-&gt;</span>
</span><span class='line'>      <span class="nx">callback</span><span class="p">()</span>
</span><span class='line'>      <span class="k">return</span>
</span><span class='line'>    <span class="p">),</span> <span class="mi">50</span>
</span><span class='line'>    <span class="k">return</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># determine whether timeout is triggered</span>
</span><span class='line'>  <span class="nv">finish = </span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">getTime</span><span class="p">()</span>
</span><span class='line'>  <span class="k">if</span> <span class="nx">finish</span> <span class="o">&gt;</span> <span class="nx">expiration</span>
</span><span class='line'>    <span class="nx">system</span><span class="p">.</span><span class="nx">stderr</span><span class="p">.</span><span class="nx">writeLine</span> <span class="s">&quot;- timed out&quot;</span> <span class="k">unless</span> <span class="nx">silence</span>
</span><span class='line'>    <span class="nx">callback</span><span class="p">()</span>
</span><span class='line'>    <span class="k">return</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># haven&#39;t timed out, haven&#39;t found object, so poll in another 100ms</span>
</span><span class='line'>  <span class="nb">window</span><span class="p">.</span><span class="nx">setTimeout</span> <span class="p">(</span><span class="nf">-&gt;</span>
</span><span class='line'>    <span class="nx">waitForStatus</span> <span class="nx">page</span><span class="p">,</span> <span class="nx">waitForStatus</span>
</span><span class='line'>    <span class="k">return</span>
</span><span class='line'>  <span class="p">),</span> <span class="mi">100</span>
</span><span class='line'>  <span class="k">return</span>
</span><span class='line'>
</span><span class='line'><span class="nv">fs = </span><span class="nx">require</span><span class="p">(</span><span class="s">&quot;fs&quot;</span><span class="p">)</span>
</span><span class='line'><span class="nv">system = </span><span class="nx">require</span><span class="p">(</span><span class="s">&quot;system&quot;</span><span class="p">)</span>
</span><span class='line'><span class="nv">page = </span><span class="nx">require</span><span class="p">(</span><span class="s">&quot;webpage&quot;</span><span class="p">).</span><span class="nx">create</span><span class="p">()</span>
</span><span class='line'><span class="nv">pageHasBeenExported = </span><span class="kc">false</span>
</span><span class='line'><span class="nv">script = </span><span class="kc">undefined</span>
</span><span class='line'><span class="nv">url = </span><span class="kc">undefined</span>
</span><span class='line'><span class="nv">silence = </span><span class="kc">undefined</span>
</span><span class='line'><span class="nv">script = </span><span class="nx">system</span><span class="p">.</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="nx">system</span><span class="p">.</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">or</span> <span class="nx">system</span><span class="p">.</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">3</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Output usage info and exit.</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;Usage: &quot;</span> <span class="o">+</span> <span class="nx">script</span> <span class="o">+</span> <span class="s">&quot; URL [silence]&quot;</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;  URL: address to open and run&quot;</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;  silence: enter &#39;silence&#39; (without quotes) to only output the page content and suppress info messages&quot;</span>
</span><span class='line'>  <span class="nx">phantom</span><span class="p">.</span><span class="nx">exit</span> <span class="mi">1</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'>  <span class="nv">url = </span><span class="nx">system</span><span class="p">.</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span class='line'>  <span class="nv">silence = </span><span class="p">(</span><span class="nx">system</span><span class="p">.</span><span class="nx">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">is</span> <span class="s">&quot;silence&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;Will render &quot;</span> <span class="o">+</span> <span class="nx">url</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span>  <span class="k">unless</span> <span class="nx">silence</span>
</span><span class='line'>  <span class="nx">page</span><span class="p">.</span><span class="nx">open</span> <span class="nx">url</span><span class="p">,</span> <span class="nf">(status) -&gt;</span>
</span><span class='line'>    <span class="k">unless</span> <span class="nx">status</span> <span class="o">is</span> <span class="s">&quot;success&quot;</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;Unable to load URL!&quot;</span>  <span class="k">unless</span> <span class="nx">silence</span>
</span><span class='line'>      <span class="nx">phantom</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1"># Start a long timeout. When the page still doesn&#39;t seem to have finished loading after 30s, something has likely gone wrong. This timeout prevents a hangup of the server.</span>
</span><span class='line'>      <span class="nb">window</span><span class="p">.</span><span class="nx">setTimeout</span> <span class="p">(</span><span class="nf">-&gt;</span>
</span><span class='line'>        <span class="nx">exportPageContents</span><span class="p">()</span>
</span><span class='line'>        <span class="k">return</span>
</span><span class='line'>      <span class="p">),</span> <span class="mi">30000</span>
</span><span class='line'>      <span class="nx">waitForStatus</span> <span class="nx">page</span><span class="p">,</span> <span class="nx">exportPageContents</span>
</span><span class='line'>    <span class="k">return</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Side note</h3>

<p>Much of this script was borrowed from <a href="http://www.pieterjongsma.com/2013/01/11/ember-google-ajax-rails.html">Ember.js, Google Ajax crawling and Rails</a>, but I didn&rsquo;t like he was detecting with angularjs was finished.  He was waiting for the page to finish its server requests, added some padding time and then finished.  Waiting for the flag to be set is a better technique, because I know angular has finished.</p>

<p>Essentially this script takes in a URL, loads the page, and then waits for the flag to be set.  If the flag takes longer than 30s to be set, it bails and just renders what it has.  If you are on Heroku, you may need to shorten this flag to 15s, because <a href="https://devcenter.heroku.com/articles/request-timeout">Heroku has a request timeout</a> of 30s.</p>

<p><a href="/blog/2014/10/07/angularjs-rails-and-seo-part-2/">Part 2</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/28/new-house/">Buying My First Real Estate Investment</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-28T09:46:17-07:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:46 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/city-houses.jpg" title="First Real Estate Investment Property" class="banner-img"  /></p>

<p>This week I will be closing on my first house that I plan on renovating and selling in the next few months.  I have been looking for a low-end flip for over a year now and I finally found one via <a href="http://networthrealtyusa.com/">NetWorth Reality</a> in Atlanta.</p>

<p>Throughout this year long process, I have learned tons about the Atlanta real estate market and in general what to look for in purchasing an investment property.</p>

<p>My criteria for my first purchase has been:</p>

<ol>
<li>The property value + $15k (for wiggle room) must be within my budget</li>
<li>No seriously large repairs should be necessary. (roof and foundation need to be in good condition)</li>
<li>Near my residence</li>
<li>Low crime neighborhood.</li>
<li>Zoned for good schools.</li>
<li><a href="http://Zillow.com">Zillow</a> and comparable houses needed agree on the value of the home*.</li>
<li>Best-case estimated profit needs to be at least $15,000.</li>
<li>Must be able to be sold quickly at a higher value</li>
<li>No condos (typically have high Homeowners Association fees and renting restrictions)</li>
</ol>


<p>The house I am buying meets most of the criteria, although its location is about 30 minutes away one direction.  As a developer that sells his time, I am not excited about having to drive that on a weekly (daily?!) basis, but I plan on outsourcing as much of the property management that I can.</p>

<p>Once the repairs are finished on the property, I want to sell this property as soon as I can, because I don&rsquo;t have time to manage renters or property repairs.  While I already have interest from one person to rent from the house,</p>

<p>Hopefully this will be a profitable endeavor, but it could just end up being an expensive learning experience.</p>

<ul>
<li>While I agree that <a href="http://Zillow.com">Zillow</a> doesn&rsquo;t know what it is talking about when it comes to home values.  I also think that the people buying the homes would not want to purchase a house too far off the price listed online.  The house I bought Zillow thinks is worth $115k and I purchased it for $47k.</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/23/how-to-get-osx-git-branch-name-in-console/">How to Get OSX Git Branch Name in Console</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-23T12:13:52-07:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2014</span></span> <span class='time'>12:13 pm</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/hills.jpg" title="How to get OSX git branch name in console" class="banner-img"  /></p>

<p>I have always had a problem of forgetting which git branch I was on and committing my changes to the wrong branch.  The best way I have found to solve this problem is to have the branch name printed in the console prompt.</p>

<p>You can modify the prompt message in OSX by setting the PS1 variable in <code>~/.bash_profile</code></p>

<p>First you need to parse the git branch name by using this function</p>

<figure class='code'><figcaption><span>.bash_profile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">parse_git_branch() {</span>
</span><span class='line'><span class="go">    git branch 2&gt; /dev/null | sed -e &#39;/^[^*]/d&#39; -e &#39;s/* \(.*\)/ (\1)/&#39;</span>
</span><span class='line'><span class="go">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now you need to set your PS1 variable so that it shows the parse branch I added a bit of color to mine so I can see it more clearly.</p>

<figure class='code'><figcaption><span>.bash_profile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">export PS1=&quot;\# \u \w\[\033[32m\]\$(parse_git_branch)\[\033[00m\] $ &quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Cheers.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/05/web-consulting/">How to Start Web Consulting</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-05T08:46:57-07:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>8:46 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/ppl-skyline.jpg" title="How to start web consulting" class="banner-img"  /></p>

<p>I have lots of advice for you. I just moved from a corporate job to rails consulting 2-4mo ago, because someone offered me more money than I could say no to.</p>

<h1>Types of consultants</h1>

<p>This is my paradigm of freelance web/mobile consulting. There are 4 types of developers that do this.</p>

<ol>
<li><p>The developer that is 30+ years old and has worked in a consulting corporate job for many years. He has a strong relationship with a handful of clients, and he leaves his job, takes the clients and now he has 2-3 companies that love him and will always give him work every year. They only do work that they want to do and at the rate they want (Usually $120+/hr).</p></li>
<li><p>There are the developers that hopefully know coding really well, but they don&rsquo;t have a strong network of clients. They are probably looking online at oDesk/Freelancer, <a href="http://twitter.com">Twitter</a>, or maybe posting on <a href="https://news.ycombinator.com/item?id=7970372">HN</a>. They probably have a website and maybe their SEO rank is super awesome for a &ldquo;{technology} {city}&rdquo; search in Google.</p>

<p> This type may even pay for services like LeadSugar. I have never subscribed to websites like that, but I feel like the most profitable awesome contracts are not going to be found posted publicly online.</p></li>
<li><p>This would be a graduate of type two, where they have 2-3 companies that love them, that will always put food on the table, and hopefully pay them what they want to get paid. I feel like there is a bit of luck to get here, but not impossible. I do not know a single developer in this type.</p></li>
<li><p>The last type is a type 2 developer, that a type 1 person is giving extra work to that they don&rsquo;t want to do or can&rsquo;t do. They share a piece of the pie with you, because they want to grow their consultancies into a developer shop, or maybe they just want to work on other things, but they still want to capitalize on their network.</p></li>
</ol>


<p>I am a type 2 developer, that knows several type 1 developers, and thus ended up in type 4. I have found that most of the jobs posted publicly, where type 2s look for work, are low paying and terrible. The clients posting them look at development as a commodity and aim for the lowest bidder. There are tons (corporate full timers looking to augment income, college kids, 3rd world, etc.) of type 2 developers looking to fill these gigs. Most of these gigs pay low. They want to spend $500 to build Facebook.com for puppies and they will have at least 8 people bidding on their project.</p>

<h1>Actionable Advice</h1>

<ol>
<li><p>If you have a terrible portfolio, look at doing a few bad jobs off of <a href="https://www.odesk.com">oDesk</a> to build that out. Write super awesome code and get good at what you do. You need to set yourself apart, skill wise, from all of the other developers.</p></li>
<li><p>Riches are in the niches. I met a developer last week that started programming at age 28, 4 years ago, and he has gotten really good at <a href="http://www.webrtc.org">WebRTC</a>. He is one of a very few &lsquo;experts&rsquo; on the stack in South East USA and anyone that wants WebRTC consulting has to talk with him. I am sure he is terrible at programming, but if he is the only webrtc pro, then that is all that matters. Find a niche.</p></li>
<li><p>Attend tech (ruby on rails, android, etc) meetups. I have a pretty strong network of developers and one of them took me under his wing and has been handing me his client work. He is taking money off the top, but I am still making my rate (which is at least 2x what I would expect from oDesk jobs), so I am happy. You will not find direct clients at tech meet ups, but you might can find mentors or other consultants that have too much on their plate.</p></li>
<li><p>Attend non-tech events in industries known to need and use technology (marketing, sales, small business, etc.). You want industries that make a lot of money, and already pay for technology. Hopefully you will find projects here like: &ldquo;I need my sales force account hooked into my <a href="http://www.infusionsoft.com">Infusionsoft</a> account with <a href="http://www.twilio.com">Twilio</a> integration so that I can be notified about new clients.&rdquo;</p>

<p> I have talked <a href="/blog/2014/06/21/goodie-hack-number-2/">before about my experiences</a> at <a href="http://goodiehack.com">Goodie Hack</a>.  There were very few developers there and lots of people looking for them.</p></li>
<li><p>Reverse sale recruiters. I get hit up by recruiters weekly asking if I want to work at the &ldquo;hottest start up in ___.&rdquo; I say, &ldquo;Hey, I am not looking for a position right now, but I am looking to take on new contracts. I will give you $500 gift card, if you refer a client to me and we seal a +1 month contract.&rdquo; Now I got a little team of people interested in helping me out.</p></li>
<li><p>Attend <a href="http://www.atlsuds.com/">startup</a> events. There are lots of people that have ideas, raised millions of dollars, but don&rsquo;t have the tech talent to build what they want to build. You need to find these people. Build relationships with VC firms. There are lots of startups with a $200,000 tech budget and no one to spend it on.</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/21/goodie-hack-number-2/">Goodie Hack #2</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-21T14:31:51-07:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>2:31 pm</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/urban.jpg" title="Goodie Hack Atlanta 2014" class="banner-img" /></p>

<p><a href="http://goodiehack.com/">Goodie Hack</a> was awesome! I met some really cool people and got to learn more about the Atlanta Food and Farming organizations.</p>

<p>I joined the Atlanta Food and Farming organization where we integerated <a href="https://www.google.com/maps/preview">Google Map Builder</a> and <a href="http://www.google.com/google-d-s/createforms.html">Google Forms</a> to build an awesome resource for sharing data about where your food comes from.  Food related organizations submit data about what they are doing to encourage healthy eating in the community.  Our map includes information like where the closet community garden is or where they can donate their compost.</p>

<p><a href="https://www.linkedin.com/in/yosepk">Yosep Kim</a> built <a href="htttp://asitgoes.com">AsItGoes.com</a> to help presenters get feed back on the presentation. Apparently, I need to be more funny, ha.  I am going to take this tool to my <a href="http://www.toastmasters.org/">Toastmaster</a>&rsquo;s club and use it for feedback for my presentations.</p>

<p>I can&rsquo;t wait to attend to the next event.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/13/entry-level-rails/">What It Takes to Be Entry Level Rails Developers</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-13T13:42:01-07:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>1:42 pm</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/bridge.jpg" title="What it takes to be entry level Rails developers" class="banner-img" /></p>

<p>I get asked a lot about what it takes to break into the Ruby on Rails industry at the various hackathons and start up weekends I have attended.  Spurred by this <a href="http://www.reddit.com/r/ruby/comments/282n9k/what_ruby_skills_are_essential_for_an_entrylevel/">/r/ruby question</a>.  I shall try my best to answer this question in a public setting.</p>

<h2>I want to this in an entry level rails developer</h2>

<ol>
<li>Build a <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUDL</a> application</li>
<li>Understand and apply <a href="http://getbootstrap.com/">bootstrap</a></li>
<li>Build a to-do application or any simple super basic app that requires a few controllers, models, etc.</li>
<li>Use slightly obscure gems, like the <a href="https://github.com/sferik/twitter">twitter</a>, <a href="https://github.com/arsduo/koala">koala</a>, <a href="https://rubygems.org/gems/mandrill-api">mandrill</a>, <a href="https://github.com/amatsuda/kaminari">kaminari</a>, <a href="https://github.com/rails/jbuilder">jbuilder</a>, etc. to prove to me that they can read the documentation and figure out how to use a gem.</li>
</ol>


<h2>Bonuses</h2>

<ol>
<li>Understanding a testing framework (<a href="https://github.com/rspec/rspec-rails">rspec</a> is my preference)</li>
<li>Knowing some basic javascript (jquery)</li>
<li>Know <a href="http://en.wikipedia.org/wiki/Test-driven_development">TDD</a></li>
<li>Knowing Thin Controllers, Fat Models</li>
<li>Attends the local ruby on rails <a href="http://meetup.com">meetup</a></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/05/rails-4-dot-1-enums-how-not-to-handle-states/">Rails 4.1 Enums: How Not to Handle States</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-05T10:08:29-07:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:08 am</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/road.jpg" title="Rails 4.1 enums: How not to handle stats" class="banner-img"/></p>

<p>I subscribe to the <a href="http://rubyweekly.com/">Ruby Weekly</a> news blog, so I can stay updated with the latest rails practices and gems.  90% of the time, there is some really good information in there.  But occasionally, sometime catches my eye that just feels wrong.</p>

<p>In this weeks email, there was a post linking to <a href="https://www.youtube.com/watch?v=UbOkNduhCfw">An introduction to Rails 4.1&rsquo;s Enum</a> where he talks about how you should use enums to handle your model states.</p>

<p><em>This upset me.</em></p>

<p>You really shouldn&rsquo;t be using enums for variables that don&rsquo;t have a strong numerical meaning (like in the example below), because it obscures the meaning of the variable&rsquo;s value.</p>

<h2>What are Enums</h2>

<p>For those that don&rsquo;t know what enums are, they essentially allow you to give names to integers.  This is really cool, because I can do things like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="n">enum</span> <span class="ss">http_code</span><span class="p">:</span> <span class="p">{</span> <span class="ss">continue</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="ss">ok</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="ss">accepted</span><span class="p">:</span> <span class="mi">202</span><span class="p">,</span> <span class="ss">redirection_perm</span><span class="p">:</span> <span class="mi">301</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now I can have named response codes to http codes.   I can do things like <code>response.http_code == :ok</code> to see if the response was valid.  Now I wont have to remember all of those http numbers, I can just remember the names of them.</p>

<p>That is what enums are good for.  State is what enums are bad for. Unfortunately the <a href="https://github.com/codemy/blogmenow/pull/3/files">example code</a> for using them in rails suggests that you use them for state.</p>

<h2>Why enums are bad</h2>

<p>Yeah, its great to have name attributes for numbers, but this gets bad when you start putting them in the database and the numbers don&rsquo;t really mean much by themselves, which is how you would look at them if you were to hit the database directly with a query.</p>

<h3>Only exist inside of the application</h3>

<p>So if my states are like so with the order being pending => processing => accepted => complete</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="n">enum</span> <span class="ss">state</span><span class="p">:</span> <span class="p">{</span> <span class="ss">pending</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="ss">processing</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="ss">accepted</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="ss">complete</span><span class="p">:</span> <span class="mi">4</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>I will only see numbers in the database.  If I do an export of the db to hand to my data analyst, he is going to have no idea what those numbers mean.  Now I have to include my db dump and my .rb file with the enums spelled out.</p>

<p>Or perhaps, you have a <a href="http://nodejs.org/">nodejs</a> application powering your chat service that also accesses the same db.  In the nodejs world, you would have to maintain a similar enum list so it can read from the states.  Your nodejs developer would have to reference your .rb file to determine what number really means what.</p>

<h3>Growth causes confusion</h3>

<p>This will also get confusing as your application grows you may want to add more states. You may end up with something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="n">enum</span> <span class="ss">state</span><span class="p">:</span> <span class="p">{</span> <span class="ss">pending</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="ss">processing</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="ss">accepted</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="ss">complete</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="ss">shipping</span><span class="p">:</span> <span class="mi">5</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The new order would be pending => processing => accepted => shipping => complete.  Which is awkward, because in the database, it looks like 1 => 2 => 3 => 5 => 4.  Which can feel a bit weird if you don&rsquo;t know what is going on.</p>

<p>If you had just left your states as named strings, you wouldn&rsquo;t have this odd ordering issue or this ambiguity of what number resides with what state.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/04/path-to-success/">My Path to Success</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-04T14:50:34-07:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>2:50 pm</span></time>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/escalator.jpg" title="My path to success" class="banner-img" /></p>

<p>My first and foremost goal is to become a successful entrepreneur.  Unfortunately, I am still working on trying to get there.  While my <a href="/coleman-laws">grandfather&rsquo;s laws</a> make a great guide for running a business, I don&rsquo;t have a business yet to run.</p>

<p>After talking with many other successful entrepreneurs, I find that everyone has to find their own path to success, but you can learn from what the greats have to say and let their advice guide you.</p>

<h2>Get out of the house</h2>

<p>I work remotely.  My day consists of waking up, working, going to Publix for food, saying hello to the checkout lady and then returning home for more work.  It is relationships with other people that <a href="http://money.usnews.com/money/personal-finance/articles/2012/03/15/why-good-friends-make-you-happy">lead to happy</a> and successful lives.</p>

<p>While I can function completely fine by working from my home office, I need to get out of the house.  I need to connect with other people to build a strong business network.  For me, I build these relationships through my local <a href="http://www.meetup.com/find/events/?keywords=programming">programming meetups</a>, attending <a href="http://startupweekend.org/">startup weekends</a>, or any <a href="http://startupgossip.com">other start up events</a>.</p>

<h2>Keep coding</h2>

<p>My day job is freelance coding rails.  I spent 8-10 hours sitting on my computer developing models, controllers, and whatever else my clients need to keep cashflow coming in, but that is boring.  I need to keep my skills sharp and balanced.</p>

<p>Great! I know ruby on rails really well, but I want to be good at lots of different tools, because I have no idea what skills I will need in the future.  That is why I play with different frameworks like <a href="/blog/2014/04/30/nodejs-chat-guide/">NodeJS</a> or <a href="blog/2014/03/11/reporting-with-rails-p1/">AngularJS</a>.</p>

<h2>Stay focused on your goals</h2>

<p>I attended the professional speakers <a href="http://www.toastmasters.org/">Toast Master&rsquo;s</a> group a few months ago and one of the speakers was in the process of writing a &ldquo;self-help guide to success&rdquo; book.  Her name and the books escapes me, but she had an interesting technique for staying focused on life.  Every morning, write your goals in a journal.  This starts your day off thinking about what you want to accomplish and keeps it focused on detecting signals that may help you accomplish your goals.</p>

<h2>Keep a short list</h2>

<p>I find myself in situations where I think: &ldquo;Great! I have nothing to do right now.&rdquo; Bullshit.  There are always things to do, I find my mind is terrible about coming up with them once its entered that state.</p>

<p>Whenever I come up with a task that needs to get done, I toss it into my <a href="http://wunderlist.com">Wunderlist</a> inbox.  Now I find that I have a moment with nothing scheduled, I can always look their for guidance.  I only put short actionable items in that list like: do laundry, ready <a href="http://engineering.richrelevance.com/bandits-recommendation-systems/">this</a> article on recommendation systems, or check <a href="http://www.zillow.com">Zillow</a> for homes.</p>

<p>Hopefully by following these goals, I will stumble through life and find myself retired by athange 30, ha!</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/3">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/index.html">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Kevin Coleman -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/lucaslew/whitespace">Whitespace</a></span>
</p>

</footer>
  








  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
